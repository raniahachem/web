{% extends 'frontbase.html.twig' %}

{% block body %}

    <!-- Carousel Start -->
    <div class="container-fluid p-0 mb-5 wow fadeIn" data-wow-delay="0.1s">
        <div id="header-carousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
<video class="w-100" autoplay loop muted>
  <source src="img/autoxpress.mp4" type="video/mp4">

</video>                    <div class="carousel-caption d-flex align-items-center justify-content-center text-start">
                        <div class="mx-sm-5 px-5" style="max-width: 900px;">
                            <h1 class="display-2 text-white text-uppercase mb-4 animated slideInDown">Get a ride in minutes</h1>
                            <h4 class="text-white text-uppercase mb-4 animated slideInDown"> <span class="fa fa-map-marker-alt text-primary"></span> Gazzela, Ariana, Ariana soghra</h4>
                            <h4 class="text-white text-uppercase mb-4 animated slideInDown"><span class="fa fa-phone-alt text-primary"></span>+216 70 445 400</h4>
                         </div>
                    </div>
                </div>
                <div class="carousel-item">
               <video class="w-100" autoplay loop muted>
               <source src="img/autoxpress2.mp4" type="video/mp4" alt ="image">
                 </video>                           <div class="carousel-caption d-flex align-items-center justify-content-center text-start">
                        <div class="mx-sm-5 px-5" style="max-width: 900px;">
                            <h1 class="display-2 text-white text-uppercase mb-4 animated slideInDown">Get a ride in minutes</h1>
                           <h4 class="text-white text-uppercase mb-4 animated slideInDown"> <span class="fa fa-map-marker-alt text-primary"></span> Gazzela, Ariana, Ariana soghra</h4>
                            <h4 class="text-white text-uppercase mb-4 animated slideInDown"><span class="fa fa-phone-alt text-primary"></span>+216 70 445 400</h4>
                         </div>
                    </div>
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#header-carousel"
                data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#header-carousel"
                data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
    <!-- Carousel End -->

<section id="about">
    <!-- About Start -->
    <div class="container-xxl py-5">
        <div class="container">
            <div class="row g-5">
                <div class="col-lg-6 wow fadeIn" data-wow-delay="0.1s">
                    <div class="d-flex flex-column">
                        <img class="img-fluid w-75 align-self-end" src="img/carpool.jpg" alt="">
                        <div class="w-50 bg-secondary p-5" style="margin-top: -25%;">
                            <h1 class="text-uppercase text-primary mb-3">Join US </h1>
                            <h2 class="text-uppercase mb-0">Quickly!</h2>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 wow fadeIn" data-wow-delay="0.5s">
                    <p class="d-inline-block bg-secondary text-primary py-1 px-4">About Us</p>
                    <h1 class="text-uppercase mb-4">WHERE RIDERS AND DRIVERS CONNECT. Learn More About Us!</h1>
                          <p> AutoXpress is the ultimate transportation solution for both drivers and riders.
                     Our innovative platform connects drivers with riders,
                      providing a fast and reliable way to get around the city. 
                      For riders, our premium transportation service offers quick and easy rides at affordable prices, 
                      making it the perfect choice for all your transportation needs. 
                      Whether you're running errands, heading to a meeting, or just need a ride across town,
                       AutoXpress is here for you.
                      For drivers, AutoXpress is the perfect opportunity to turn your car into a money-making machine.
                       By joining our platform, you can earn extra income by providing rides to riders in your area.
                        With flexible hours and the ability to work whenever you want, 
                        becoming an AutoXpress driver is the perfect way to supplement your income.

                    <p class="mb-4">So why wait? Whether you're a rider looking for a fast and reliable ride or a driver
                     looking to earn some extra income, sign up today and start enjoying the convenience of AutoXpress!</p>
                    </p> <div class="row g-4">
                        <div class="col-md-6">
                            <h3 class="text-uppercase mb-3">Since 2023</h3>
                        </div>
                        <div class="col-md-6">
                            <h3 class="text-uppercase mb-3">1000+ clients</h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </section>
    <!-- About End -->
 
<section id="service">
    <!-- Service Start -->
    <div class="container-xxl py-5">
        <div class="container">
            <div class="text-center mx-auto mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 600px;">
                <p class="d-inline-block bg-secondary text-primary py-1 px-4">Services</p>
                <h1 class="text-uppercase">What We Provide</h1>
            </div>
            <div class="row g-4">
                <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="0.1s">
                    <div class="service-item position-relative overflow-hidden bg-secondary d-flex h-100 p-5 ps-0">
                        <div class="bg-dark d-flex flex-shrink-0 align-items-center justify-content-center" style="width: 60px; height: 60px;">
                            <img class="img-fluid" src="img/ride.png" alt="">
                        </div>
                        <div class="ps-4">
                            <h3 class="text-uppercase mb-3">Ride</h3>
                            <p>Share a ride and save money with our ride service.</p>
                            <span class="text-uppercase text-primary">Join us</span>
                        </div>
                        <a class="btn btn-square" href=""><i class="fa fa-plus text-primary"></i></a>
                    </div>
                </div>
                
               
                <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="0.3s">
                    <div class="service-item position-relative overflow-hidden bg-secondary d-flex h-100 p-5 ps-0">
                        <div class="bg-dark d-flex flex-shrink-0 align-items-center justify-content-center" style="width: 60px; height: 60px;">
                            <img class="img-fluid" src="img/drive.png" alt="">
                        </div>
                        <div class="ps-4">
                            <h3 class="text-uppercase mb-3">Drive</h3>
                            <p>Efficient and convenient driving service for your daily commute.</p>
                            <span class="text-uppercase text-primary">Join us</span>
                        </div>
                        <a class="btn btn-square" href=""><i class="fa fa-plus text-primary"></i></a>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="0.5s">
                    <div class="service-item position-relative overflow-hidden bg-secondary d-flex h-100 p-5 ps-0">
                        <div class="bg-dark d-flex flex-shrink-0 align-items-center justify-content-center" style="width: 60px; height: 60px;">
                            <img class="img-fluid" src="img/deliver.png" alt="">
                        </div>
                        <div class="ps-4">
                            <h3 class="text-uppercase mb-3">Deliver</h3>
                            <p>Fast and reliable delivery service for your packages and parcels.</p>
                            <span class="text-uppercase text-primary">Join us</span>
                        </div>
                        <a class="btn btn-square" href=""><i class="fa fa-plus text-primary"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Service End -->
</section>

<section id="#">

    <!-- Team Start -->
    <div class="container-xxl py-5">
        <div class="container">

            <div class="text-center mx-auto mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 600px;">
                <p class="d-inline-block bg-secondary text-primary py-1 px-4">Our Drivers</p>
                <h1 class="text-uppercase">Meet Our Drivers</h1>
            </div>

            <div class="row g-4">
                <div class="col-lg-3 col-md-6 wow fadeInUp" data-wow-delay="0.1s">
                    <div class="team-item">

                       
                      
 {% for a in conducteurData %}



                       
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 wow fadeInUp" data-wow-delay="0.5s">
                    <div class="team-item">
                        <div class="team-img position-relative overflow-hidden">
    <img class="img-fluid"  src="{{ a.getImageConducteur() }}" alt="" style="height:400px" >
                            <div class="team-social">
                                <a class="btn btn-square" href=""><i class="fab fa-facebook-f"></i></a>
                                <a class="btn btn-square" href=""><i class="fab fa-twitter"></i></a>
                                <a class="btn btn-square" href=""><i class="fab fa-instagram"></i></a>
                            </div>
                        </div>
                         <div class="bg-secondary text-center p-4">
                            <h5 class="text-uppercase">{{ a.getPrenomConducteur() }} {{ a.getNomConducteur() }}</h5>
                            <span class="text-primary">Driver</span>
                        </div>

{% endfor %}
                </div>
        </div>
    </div></section>
    <!-- Team End -->

   <div class="text-center mx-auto mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 600px;">
                <p class="d-inline-block bg-secondary text-primary py-1 px-4">Review</p>
                <h1 class="text-uppercase">What Our Clients Say!</h1>
            </div>
<section id="review">
  <div id="review-container" class="h-100 bg-secondary rounded p-4">
    <div class="d-flex align-items-center justify-content-between mb-2">
      <h6 class="mb-0">Ratings</h6>
      <a href="">Show All</a>
    </div>
    {% for conducteur in conducteurData %}
    <div class="d-flex align-items-center border-bottom py-3">
      <img class="rounded-circle flex-shrink-0" src="{{ conducteur.getImageConducteur() }}" alt="" style="width: 40px; height: 40px; ">
      <div class="w-100 ms-3">
        <div class="d-flex w-100 justify-content-between">
          <h6 class="mb-0">{{ conducteur.getNomConducteur() }} {{ conducteur.getPrenomConducteur() }}</h6>
          {% set count = 0 %}
          {% set totalRating = 0 %}
          {% for avis in avisData %}
          {% if avis.conducteur.getIdConducteur() == conducteur.getIdConducteur() %}
          {% set totalRating = totalRating + avis.avis.getRating() %}
          {% set count = count + 1 %}
          {% endif %}
          {% endfor %}
          {% if count > 0 %}
          {% set moyenne = totalRating / count %}
          <small>{{ moyenne|number_format(1) }}</small>
          <div class="star-rating">
            {% for i in 1..5 %}
            {% if i <= moyenne %}
            <span class="fa fa-star checked"></span>
            {% elseif i <= moyenne + 0.5 %}
            <span class="fa fa-star-half checked"></span>
            {% else %}
            <span class="fa fa-star"></span>
            {% endif %}
            {% endfor %}
          </div>
          {% endif %}
        </div>
      </div>
    </div>
    <div>
    <form action="{{ path('add_commentc') }}" method="POST" onsubmit="return checkComment({{ conducteur.getIdConducteur() }});" >
                            <div class="d-flex align-items-center border-bottom py-3" >
      <img class="rounded-circle flex-shrink-0" src="img/profile.png" alt="" style="width: 40px; height: 40px;">
                                <div class="w-100 ms-3">
                                  
                                    <div class="form-floating comment-container">
    <input class="form-control" placeholder="Leave a comment here" name="contenu" id="floatingTextarea{{ conducteur.getIdConducteur() }}" style="height: 50px; width:100%; border-radius: 15px ;background: #0d0d10; border-color: black;  margin-top: 7px;"/>
    <button type="submit" class="btn btn-success rounded-pill evaluate-driver-btn" id="comment-done-btn-{{ conducteur.getIdConducteur() }}">Send</button>
    <input type="hidden" name="id_client" value="13" />
    <input type="hidden" name="id_conducteur" value="{{ conducteur.getIdConducteur() }}" />
    <label for="floatingTextarea{{ conducteur.getIdConducteur() }}">Comments</label>
</div>
                                </div>
                            </div>
                        </form>
    </div>
    <div style="height: 100px; overflow-y: scroll;"   class="h-100 bg-secondary rounded p-4">
      <div class="d-flex align-items-center justify-content-between mb-2">
        <h6 class="mb-0">Comments</h6>
      </div>
      
{% for item in commentaireData %}
  {% if item.commentaire.getIdConducteur() == conducteur.getIdConducteur() %}
    <div  class="d-flex align-items-center border-bottom py-3">
      <img class="rounded-circle flex-shrink-0" src="img/profile.png" alt="" style="width: 40px; height: 40px;">
      <div class="w-100 ms-3">
        <div class="d-flex w-100 justify-content-between">
          <h6 class="mb-0">{{ item.client.getNomClient() }} {{ item.client.getPrenomClient() }}</h6>
          <small>{{ item.commentaire.getDate()|date('Y-m-d H:i:s')}}</small>
          <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <i class="fas fa-ellipsis-h dots-icon"></i>
            </button>
            
            <div style="background-color: black;" id="dropdown-menu" class="dropdown-menu" style="display: none;">
              <a href="{{ path('client_commentaire_delete', {'id': item.commentaire.getId()}) }}" style="background-color: black; color: red;"class="dropdown-item delete-item" data-id="{{ item.commentaire.getId() }}">Delete</a>
              <a href="{{ path('client_commentaire_update', {'id': item.commentaire.getId()}) }}" style="background-color: black; color: red;"class="dropdown-item update-item" data-id="{{ item.commentaire.getId() }}">Update</a>
            </div>
          </div>
        </div>
        <span>{{ item.commentaire.getContenu() }}</span>
      </div>
    </div>
  {% endif %}
{% endfor %}

    </div>
    {% endfor %}
   

  </div>
   
           <div class="container-fluid pt-4 px-4">

    <div class="bg-secondary rounded h-100 p-4">
        <h6 class="mb-4">Rate the driver</h6>

        <div class="container-fluid pt-4 px-4"  >
            <div class="row g-4">
                <div class="col-sm-12 col-md-6 col-xl-4">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                                <h6 class="mb-0">Driver</h6>
                                
                            </div>
 {% for a in conducteurData %}
  <div class="d-flex align-items-center border-bottom py-3" style="width:1130px;">
    <img class="rounded-circle flex-shrink-0" src="{{ a.getImageConducteur() }}" alt="" style="width: 40px; height: 40px;">
    <div class="w-100 ms-3">
      <div class="d-flex w-100 justify-content-between">
        <h6 class="mb-0">{{ a.getPrenomConducteur() }} {{ a.getNomConducteur() }}</h6>
      </div>
      <div class="driver-rating" data-rating="0">
        <span class="fa fa-star" data-rating="1"></span>
        <span class="fa fa-star" data-rating="2"></span>
        <span class="fa fa-star" data-rating="3"></span>
        <span class="fa fa-star" data-rating="4"></span>
        <span class="fa fa-star" data-rating="5"></span>
      </div>
     <form action="{{ path('add_avis') }}" method="POST" style="margin-left: 700px;margin-top: -55px; ">
        <input type="hidden" name="id_client" value="13" />
        <input  type="hidden" name="id_conducteur" value="{{ a.getIdConducteur() }}" />
        <input type="hidden" name="rating"  class="driver-rating-value" value="0" />
        <button type="submit" class="btn btn-success rounded-pill m-2 evaluate-driver-btn">Send</button>
      </form>
    </div>
  </div>
{% endfor %}


                            </div>
                        </div>
                    </div>
                            </div>
                        </div>
                          </div>
    </div>
</div>
        </section>




 <div class="navigation">
            {{ knp_pagination_render(conducteurData) }}
        </div>

 <script>
  const conducteurs = document.querySelectorAll(".driver-rating");

  for (let i = 0; i < conducteurs.length; i++) {
    const stars = conducteurs[i].querySelectorAll(".fa-star");

    for (let j = 0; j < stars.length; j++) {
      stars[j].addEventListener("click", function() {
        const ratingInput = conducteurs[i].parentNode.querySelector(".driver-rating-value");
        const index = parseInt(this.getAttribute("data-rating"));
        
        for (let k = 0; k < stars.length; k++) {
          if (k < index) {
            stars[k].classList.add("rated");
          } else {
            stars[k].classList.remove("rated");
          }
        }
        
        ratingInput.value = index;
      });
    }
  }
</script>
 <script>
  const conducteurs = document.querySelectorAll(".driver-rating");

  for (let i = 0; i < conducteurs.length; i++) {
    const stars = conducteurs[i].querySelectorAll(".fa-star");

    for (let j = 0; j < stars.length; j++) {
      stars[j].addEventListener("click", function() {
        const ratingInput = conducteurs[i].parentNode.querySelector(".driver-rating-value");
        const index = parseInt(this.getAttribute("data-rating"));
        
        for (let k = 0; k < stars.length; k++) {
          if (k < index) {
            stars[k].classList.add("rated");
          } else {
            stars[k].classList.remove("rated");
          }
        }
        
        ratingInput.value = index;
      });
    }
  }
</script>
<style>
  .fa-star {
    color: #ccc;
    cursor: pointer;
    font-size: 1.5rem;
    transition: all 0.2s ease-in-out;
  }

  .fa-star.rated,
  .fa-star.hovered {
    color: yellow;
  }
.star-rating {
  display: inline-block;
  font-size: 20px;
  line-height: 1;
}

.fa-star {
  color: #ccc;
}

.checked {
  color: #f7d32b;
}


  #avis-form-container {
  display: block;
}

#avis-form-container.hidden {
  display: none;
}
</style>
<script>
const addCommentBtn = document.querySelector('.add-comment-btn');
const commentFormContainer = document.querySelector('#comment-form-container');

addCommentBtn.addEventListener('click', () => {
    if (commentFormContainer.hasAttribute('hidden')) {
        commentFormContainer.removeAttribute('hidden');
    } else {
        commentFormContainer.setAttribute('hidden', '');
    }
});
</script>
<script>
  $(document).on('click', '.delete-item', function(e) {
    e.preventDefault();
    
    var url = $(this).attr('href');
    var id = $(this).data('id');
    
    if (confirm('Are you sure you want to delete this item?')) {
      $.ajax({
        url: url,
        method: 'DELETE',
        data: {
          id: id
        },
        success: function(response) {
          // Redirect to the client page after successful deletion
          window.location.href = '{{ path('app_client') }}';
        },
        error: function(xhr, status, error) {
          console.log(error);
        }
      });
    }
  });
  
</script>
<script>
  $('.update-item').on('click', function(e) {
    e.preventDefault();
    var id = $(this).data('id');
    // show alert here
    alert('Edit the comment with ID ' + id);
    // redirect to the update item page or show a modal
    window.location.href = $(this).attr('href');
  });
</script>
<script>
$(document).ready(function() {
  $('.dropdown-toggle').on('click', function() {
    $(this).siblings('.dropdown-menu').toggle();
  });
  
  $('.delete-item').on('click', function(e) {
    e.preventDefault();
    var itemId = $(this).data('id');
    // make an AJAX call to delete the item
    $.ajax({
      url: '/delete_item/' + itemId,
      type: 'DELETE',
      success: function(response) {
        // reload the page or update the UI
      },
      error: function(xhr, status, error) {
        console.log('Error:', error);
      }
    });
  });
  
$('.update-item').on('click', function(e) {
  e.preventDefault();
  var id = $(this).data('id');
  var contenu = $(this).data('contenu');
  $('#editCommentModal').find('form').attr('action', '/commentaireclientupdate/' + id);
  $('#editCommentModal').find('#contenu').val(contenu);
  $('#editCommentModal').modal('show');
});

});
</script>


    <!-- Template Javascript -->
    <script>
    (function ($) {
    "use strict";

    // Spinner
    var spinner = function () {
        setTimeout(function () {
            if ($('#spinner').length > 0) {
                $('#spinner').removeClass('show');
            }
        }, 1);
    };
    spinner();
    
    
    // Initiate the wowjs
    new WOW().init();


    // Sticky Navbar
    $(window).scroll(function () {
        if ($(this).scrollTop() > 300) {
            $('.sticky-top').addClass('shadow-sm').css('top', '0px');
        } else {
            $('.sticky-top').removeClass('shadow-sm').css('top', '-100px');
        }
    });
    
    
    // Back to top button
    $(window).scroll(function () {
        if ($(this).scrollTop() > 300) {
            $('.back-to-top').fadeIn('slow');
        } else {
            $('.back-to-top').fadeOut('slow');
        }
    });
    $('.back-to-top').click(function () {
        $('html, body').animate({scrollTop: 0}, 1500, 'easeInOutExpo');
        return false;
    });


    // Testimonials carousel
    $('.testimonial-carousel').owlCarousel({
        autoplay: true,
        smartSpeed: 1000,
        loop: true,
        nav: false,
        dots: true,
        items: 1,
        dotsData: true,
    });

    
})(jQuery);

</script>
<script>
const addCommentBtn = document.querySelector('.add-avis-btn');
const commentFormContainer = document.querySelector('#avis-form-container');

addCommentBtn.addEventListener('click', () => {
  commentFormContainer.classList.toggle('hidden');
});
</script>
<style>
/* Pagination styles */
.navigation {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 20px;
    background-color: #ffffff42;
    border-radius: 5px;
padding: 7px;
}

.navigation ul {
    display: flex;
    list-style: none;
    padding: 0;
}

.navigation ul li {
    margin: 0 5px;
}

.navigation ul li a {
    display: block;
    padding: 10px;
    border-radius: 5px;
    background-color: white;
    color: #333;
    text-align: center;
    text-decoration: none;
    box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
}

.navigation ul li.active a {
    background-color: #333;
    color: white;
}

.navigation ul li.disabled a {
    color: #ccc;
    cursor: not-allowed;
}
.navigation .pagination li a {
  background-color: black;
  color: white;
  padding: 5px 10px;
  border-radius: 5px;
  margin-right: 5px;
}

</style>
<style>

/* For Chrome, Edge, and Safari */
div::-webkit-scrollbar {
  width: 8px;
}

div::-webkit-scrollbar-track {
  background: #f5f5f5;
}

div::-webkit-scrollbar-thumb {
  background-color: #ccc;
  border-radius: 20px;
  border: 3px solid #f5f5f5;
}

/* For Firefox */
div {
  scrollbar-width: thin;
  scrollbar-color: #ccc #f5f5f5;
}

div::-moz-scrollbar {
  width: 8px;
}

div::-moz-scrollbar-track {
  background: #f5f5f5;
}

div::-moz-scrollbar-thumb {
  background-color: #ccc;
  border-radius: 20px;
  border: 3px solid #f5f5f5;
}
</style>
<style>
    .comment-container {
        display: flex;
        align-items: center;
    }
    .comment-container input, .comment-container label {
        flex: 1;
    }
    .comment-container button {
        margin-left: 10px;
    }
</style>
    <script src="js/main.js"></script>
{% endblock %}